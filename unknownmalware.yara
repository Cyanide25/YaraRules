
rule Unknown_Malware {
    meta:
        description = "Yara rules for Unknown Malware"
        md5 = "6147b3df04d5d93d9186f3ede6e74b71"
        sha1 = "28781551d4b8fc8700672fe2320945b56155aff2"
        filename = "Unknown_Malware.exe"
        author = "Cathrine Nino and Razan Alahwal"
    strings:
        $PE_Byte = "MZ"
        $path1file = "VB6.OLB" ascii
        $path2file = "Project1.vbp" wide
        $Created_File = "Hacked.txt" wide
        $Exe_File = "updator.exe" wide
        $s = "PSUT.dll is missing!" wide
        $cipher = "CaesarCipher" ascii
        $http_request = "http://www.example.com/post_handler" wide
        $SQL_Statement = "SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled = True" fullword wide
    condition:
        ($PE_Byte at 0) and ($path1file and $s and $path2file) or ($Exe_File and $cipher and $Created_File) 
        or ($http_request and $SQL_Statement and $s)
}
